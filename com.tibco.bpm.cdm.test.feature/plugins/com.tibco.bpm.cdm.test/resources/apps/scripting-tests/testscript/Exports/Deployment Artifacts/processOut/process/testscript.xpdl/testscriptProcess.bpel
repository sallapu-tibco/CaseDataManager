<?xml version="1.0" encoding="UTF-8"?>
<bpws:process exitOnStandardFault="no" name="testscriptProcess"
    suppressJoinFailure="yes" tibex:bxVersion="11.0.0"
    tibex:dataFieldDescriptorClass="com.example.testscript.testscript.testscriptProcess"
    tibex:dataFieldDescriptorScript="process-js/testscript/testscriptProcess/testscriptProcess.js"
    tibex:explicitCompensation="yes"
    tibex:xpdlId="_e3bEIZi-Eemai478WcQ_jw"
    xmlns:bpws="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:tibex="http://www.tibco.com/bpel/2007/extensions" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <tibex:VariableDescriptor type="PersistentBatching">
        <task name="ScriptTaskImplicitTypeConversion">
            <startingVariables>
                <variable>DFFixedPointNumberImplicit2</variable>
                <variable>DFTime</variable>
                <variable>DFDateTimeZone</variable>
                <variable>DFImplicitText</variable>
                <variable>DFPerformer</variable>
                <variable>DFDate</variable>
                <variable>DFFixedPointNumber</variable>
                <variable>DFUri</variable>
                <variable>DFFixedPointNumberImplicit1</variable>
                <variable>DFNumberImplicit</variable>
            </startingVariables>
        </task>
        <task name="ScriptTaskSimpleDataManipulation">
            <startingVariables>
                <variable>DFBoolean</variable>
                <variable>DFTime</variable>
                <variable>DFDateTimeZone</variable>
                <variable>DFText</variable>
                <variable>DFPerformer</variable>
                <variable>DFDate</variable>
                <variable>DFFixedPointNumber</variable>
                <variable>DFUri</variable>
                <variable>DFNumber</variable>
            </startingVariables>
        </task>
    </tibex:VariableDescriptor>
    <bpws:documentation>*** Generated by TIBCO Business Studio.</bpws:documentation>
    <bpws:variables>
        <bpws:variable name="DFText"
            tibex:xpdlId="_pXE1sJjFEemai478WcQ_jw" type="xsd:string"/>
        <bpws:variable name="DFNumber"
            tibex:xpdlId="_tGefoJjFEemai478WcQ_jw" type="xsd:double"/>
        <bpws:variable name="DFFixedPointNumber"
            tibex:xpdlId="_ydkgIJjFEemai478WcQ_jw" type="xsd:double"/>
        <bpws:variable name="DFBoolean"
            tibex:xpdlId="_1hQ6oJjFEemai478WcQ_jw" type="xsd:boolean"/>
        <bpws:variable name="DFDate"
            tibex:xpdlId="_5HR_EJjFEemai478WcQ_jw" type="xsd:date"/>
        <bpws:variable name="DFTime"
            tibex:xpdlId="_7lcDkJjFEemai478WcQ_jw" type="xsd:time"/>
        <bpws:variable name="DFDateTimeZone"
            tibex:xpdlId="_8_2MEJjFEemai478WcQ_jw" type="xsd:dateTime"/>
        <bpws:variable name="BOMFieldTestData"
            tibex:class="com.example.businessobjectmodel.testclass" tibex:xpdlId="_UjgDoJjGEemai478WcQ_jw"/>
        <bpws:variable name="DFImplicitText"
            tibex:xpdlId="_QNfqAL6UEemCEvD9pZ0wsA" type="xsd:string"/>
        <bpws:variable name="DFUri"
            tibex:xpdlId="_6jci8L6UEemCEvD9pZ0wsA" type="xsd:string"/>
        <bpws:variable name="DFPerformer"
            tibex:xpdlId="_-wdV8L6UEemCEvD9pZ0wsA" type="xsd:string"/>
        <bpws:variable name="DFFixedPointNumberImplicit1"
            tibex:xpdlId="_hP9g8L6eEemCEvD9pZ0wsA" type="xsd:double"/>
        <bpws:variable name="DFFixedPointNumberImplicit2"
            tibex:xpdlId="_mM1DkL6eEemCEvD9pZ0wsA" type="xsd:double"/>
        <bpws:variable name="DFNumberImplicit"
            tibex:xpdlId="_9Iu-oL6eEemCEvD9pZ0wsA" type="xsd:double"/>
    </bpws:variables>
    <bpws:extensions>
        <bpws:extension mustUnderstand="yes" namespace="http://www.tibco.com/bpel/2007/extensions"/>
    </bpws:extensions>
    <bpws:eventHandlers/>
    <bpws:flow name="_BX_flow_-yZbENrtEem48ey02mVbRA">
        <bpws:links>
            <bpws:link
                name="_9JrtcJjZEemai478WcQ_jw to _Xz_hUL6UEemCEvD9pZ0wsA" tibex:xpdlId="_Xz_hUb6UEemCEvD9pZ0wsA"/>
            <bpws:link
                name="ScriptTaskBOMManipulation to _9JrtcJjZEemai478WcQ_jw" tibex:xpdlId="_9JrtcZjZEemai478WcQ_jw"/>
            <bpws:link name="_Xz_hUL6UEemCEvD9pZ0wsA to EndEvent" tibex:xpdlId="_glAnU5i-Eemai478WcQ_jw"/>
            <bpws:link name="StartEvent to ScriptTaskBOMManipulation" tibex:xpdlId="_A5xgcZjFEemai478WcQ_jw"/>
        </bpws:links>
        <bpws:extensionActivity>
            <tibex:receiveEvent createInstance="yes" eventTimeout="0"
                name="StartEvent" tibex:type="startEvent"
                tibex:xpdlId="_glAnUZi-Eemai478WcQ_jw" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:sources>
                    <bpws:source linkName="StartEvent to ScriptTaskBOMManipulation"/>
                </bpws:sources>
                <tibex:eventSource>
                    <tibex:startEvent eventType="Default"/>
                </tibex:eventSource>
            </tibex:receiveEvent>
        </bpws:extensionActivity>
        <bpws:empty name="EndEvent" tibex:migrationAllowed="yes"
            tibex:type="endEvent" tibex:xpdlId="_glAnUpi-Eemai478WcQ_jw">
            <bpws:targets>
                <bpws:target linkName="_Xz_hUL6UEemCEvD9pZ0wsA to EndEvent"/>
            </bpws:targets>
        </bpws:empty>
        <bpws:extensionActivity>
            <tibex:extActivity name="ScriptTaskBOMManipulation"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_A5xgcJjFEemai478WcQ_jw" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="StartEvent to ScriptTaskBOMManipulation"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="ScriptTaskBOMManipulation to _9JrtcJjZEemai478WcQ_jw"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[//initialize bom 
var bomData = factory.com_example_businessobjectmodel.createTestclass();

bomData.attributeText = "BOM Data value";
bomData.attributeText = bomData.attributeText.concat(" - Simple");
bomData.attributeText = bomData.attributeText.toLowerCase();
//expected value is - bom data value - simple

//bom boolean manipulation
bomData.attributeBoolean = false;
//boolean values attribute has the same operations as text
//expected value is - true

//bom uri manipulation
bomData.attributeUri = "http://www.tibco-integration.com";
bomData.attributeUri = bomData.attributeUri.concat("/help/guid=abcdefghiklmnop");
bomData.attributeUri = bomData.attributeUri.substr(0,46);
bomData.attributeUri = bomData.attributeUri.concat("#1234");
//expected value is - "http://www.tibco-integration.com/help/guid=abcd#1234"

//bom number manupulation
bomData.attributeNumber = 1234.56;
bomData.attributeNumber.add(7890.123);
bomData.attributeNumber.multiply(0.1);
bomData.attributeNumber.divide(0.2);
bomData.attributeNumber.subtract(1234);
//‭expected value is - 3,328.3415‬

//bom fixed point manupulation
bomData.attributeFixedPointNumber = 123456.7891;
bomData.attributeFixedPointNumber.add(123456.7891);
bomData.attributeFixedPointNumber.multiply(2);
bomData.attributeFixedPointNumber.divide(2);
bomData.attributeFixedPointNumber.subtract(1111.1111);
//‭expected value is - 245802.4671

//bom date manupulation
bomData.attributeDate = new Date("2019-01-02");
bomData.attributeDate.setDate(12);
bomData.attributeDate.setMonth(11);
bomData.attributeDate.setFullYear(2079);
//‭expected value is - 2079-11-12‬

//bom time manupulation
//ACE-2330
//temporarily commented - bomData.attributeTime = new Date("23:19:11");
bomData.attributeTime.setHours(22);
bomData.attributeTime.setMinutes(44);
bomData.attributeTime.setSeconds(11);
//‭expected value is - 22:44:11

//bom DateTimeZone manupulation
//ACE-2330
//temporarily commented - bomData.attributeDateTimeTZ = new Date('2019-11-12T19:31:11.231+4:30');
bomData.attributeDateTimeTZ.setFullYear(2012);
bomData.attributeDateTimeTZ.setMonth(3);
bomData.attributeDateTimeTZ.setDate(4);
bomData.attributeDateTimeTZ.setHours(6);
bomData.attributeDateTimeTZ.setMinutes(10);
bomData.attributeDateTimeTZ.setSeconds(24);
bomData.attributeDateTimeTZ.setMilliseconds(100);
Log.write(bomData.attributeDateTimeTZ.getTimezoneOffset());
//missing set - bomData.attributeDateTimeTZ.getTimezoneOffset()
//expected value is - 2012-03-04T06:10:24.100+4:30Z


//"{\"attributeText\":\"bom data value - simple\",
//\"attributeTime\":\"22:44:11\",
//\"attributeDate\":\"2079-12-12\",
//\"attributeDateTimeTZ\":\"2012-04-04T05:10:24.100Z\",
//\"attributeNumber\":1234.56,
//\"attributeUri\":\"http://www.tibco-integration.com/help/guid=abc#1234\",
//\"attributeBoolean\":\"false\",
//\"attributeFixedPointNumber\":123456.7891}]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="ScriptTaskSimpleDataManipulation"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_9JrtcJjZEemai478WcQ_jw" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="ScriptTaskBOMManipulation to _9JrtcJjZEemai478WcQ_jw"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_9JrtcJjZEemai478WcQ_jw to _Xz_hUL6UEemCEvD9pZ0wsA"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[//boolean df
data.DFBoolean = true;
//expected value - true

//date df
data.DFDate = new Date();
data.DFDate.setDate(26);
data.DFDate.setMonth(4);
data.DFDate.setFullYear(2019);
//expected value - 2019-04-26

//time df
//ACE-2330
//temporarily commented - data.DFTime = new Date('11:11:11');
data.DFTime.setHours(17);
data.DFTime.setMinutes(40);
data.DFTime.setSeconds(34);
//expected value - 17:40:34

//datetimetz df
//ACE-2330
//temporarily commented - data.DFDateTimeZone = new Date();
data.DFDateTimeZone.setFullYear(1992);
data.DFDateTimeZone.setDate(1);
data.DFDateTimeZone.setMonth(6);
data.DFDateTimeZone.setHours(18);
data.DFDateTimeZone.setMinutes(24);
data.DFDateTimeZone.setSeconds(16);
data.DFDateTimeZone.setMilliseconds(343);
//expected value - 1992-06-01T18:24:16.343Z

//fixed point number df
data.DFFixedPointNumber = 248.163;
data.DFFixedPointNumber.add(0.836);
//expected value - 248.999

//number df
data.DFNumber = 2480;
data.DFNumber.add(836);
//expected value - 3316

//text df
data.DFText = "Simple Data Text";
data.DFText.replace("Text","String");
data.DFText.concat("- value");
data.DFText.toUpperCase();
//expected value - SIMPLE DATA STRING - VALUE

//uri df
data.DFUri = "http://www.tibco.com";
data.DFUri.concat("/customers");
//expected value - http://www.tibco.com/customers

//performer df
data.DFPerformer = 'resource1';

//Assert.assertEquals(result.get("DFBoolean"), Boolean.TRUE, "incorrect value");
//Assert.assertEquals(result.get("DFDate"), "2019-05-26", "incorrect value");
//ACE-1879 is resolved
//Assert.assertEquals(result.get("DFTime"), "17:40:34", "incorrect value");
//ACE-1879 is resolved
//Assert.assertEquals(result.get("DFDateTimeZone"), "1992-07-01T17:24:16.343Z", "incorrect value");
//Assert.assertEquals(result.get("DFFixedPointNumber"), 248.999, "incorrect value");
//Assert.assertEquals(result.get("DFNumber"), 3316, "incorrect value");
//Assert.assertEquals(result.get("DFText"), "SIMPLE DATA STRING- VALUE", "incorrect value");
//Assert.assertEquals(result.get("DFUri"), "http://www.tibco.com/customers", "incorrect value");
//Assert.assertEquals(result.get("DFPerformer"), "resource1", "incorrect value");]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="ScriptTaskImplicitTypeConversion"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_Xz_hUL6UEemCEvD9pZ0wsA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_9JrtcJjZEemai478WcQ_jw to _Xz_hUL6UEemCEvD9pZ0wsA"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_Xz_hUL6UEemCEvD9pZ0wsA to EndEvent"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.DFImplicitText = data.DFImplicitText + 'Date: ';
data.DFImplicitText = data.DFImplicitText + data.DFDate;
data.DFImplicitText = data.DFImplicitText + ' DateTimeZome: ';
data.DFImplicitText = data.DFImplicitText + data.DFDateTimeZone;
data.DFImplicitText = data.DFImplicitText + ' Time: ';
data.DFImplicitText = data.DFImplicitText + data.DFTime;
data.DFImplicitText = data.DFImplicitText + ' URI: ';
data.DFImplicitText = data.DFImplicitText + data.DFUri;
data.DFImplicitText = data.DFImplicitText + ' Performer : ';
data.DFImplicitText = data.DFImplicitText + data.DFPerformer;
//Assert.assertEquals(result.get("DFImplicitText"), "Date: 2019-05-26 DateTimeZone: 1992-07-01T17:24:16.343Z Time: 17:40:34 URI: http://www.tibco.com/customers Performer : resource1, "incorrect value");
//number assigned to fixed point number
data.DFNumberImplicit = 123.4564;
data.DFFixedPointNumberImplicit1 = data.DFNumberImplicit;
data.DFNumberImplicit = 123.4567;
data.DFFixedPointNumberImplicit2 = data.DFNumberImplicit;
//fixed point number assigned to number
data.DFNumberImplicit = data.DFFixedPointNumber;
//Assert.assertEquals(result.get("DFNumberImplicit"), 248.999, "incorrect value");
//Assert.assertEquals(result.get("DFFixedPointNumberImplicit1"), 123.456, "incorrect value");
//Assert.assertEquals(result.get("DFFixedPointNumberImplicit2"), 123.457, "incorrect value");]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
    </bpws:flow>
</bpws:process>
