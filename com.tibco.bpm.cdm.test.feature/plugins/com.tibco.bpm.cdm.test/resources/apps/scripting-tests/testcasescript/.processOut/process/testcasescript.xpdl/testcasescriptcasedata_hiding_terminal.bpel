<?xml version="1.0" encoding="UTF-8"?>
<bpws:process exitOnStandardFault="no"
    name="testcasescriptcasedata_hiding_terminal"
    suppressJoinFailure="yes" tibex:bxVersion="11.0.0"
    tibex:dataFieldDescriptorClass="com.example.testcasescript.testcasescript.testcasescriptcasedata_hiding_terminal"
    tibex:dataFieldDescriptorScript="process-js/testcasescript/testcasescriptcasedata_hiding_terminal/testcasescriptcasedata_hiding_terminal.js"
    tibex:explicitCompensation="yes"
    tibex:xpdlId="_7ChVcNVaEemTTsOsy2W0nA"
    xmlns:bpws="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:tibex="http://www.tibco.com/bpel/2007/extensions" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <tibex:VariableDescriptor type="PersistentBatching">
        <task name="CreateAccounts">
            <startingVariables>
                <variable>accountBOMs</variable>
                <variable>accountCases</variable>
            </startingVariables>
        </task>
        <task name="SearchWillsearchnonterminalcases">
            <startingVariables>
                <variable>accountCasesSimpleSearch</variable>
            </startingVariables>
        </task>
        <task name="CreateCustomersScript">
            <startingVariables>
                <variable>customerBOMs</variable>
            </startingVariables>
        </task>
        <task name="UpdateNonTerminalAccounttoTerminalScript">
            <startingVariables>
                <variable>accountBOMUpdateToTerminal</variable>
                <variable>accountCaseUpdateToTerminal</variable>
                <variable>accountCases</variable>
            </startingVariables>
        </task>
        <task name="FindAllWillfindnonterminalcases">
            <startingVariables>
                <variable>accountCasesFindAll</variable>
            </startingVariables>
        </task>
        <task name="CreateAccountsScript">
            <startingVariables>
                <variable>accountBOMs</variable>
            </startingVariables>
        </task>
        <task name="FindBycriteriaWillfindnonterminalcases">
            <startingVariables>
                <variable>accountCasesFindByCriteria</variable>
            </startingVariables>
        </task>
        <task name="CreateCustomers">
            <startingVariables>
                <variable>customerBOMs</variable>
                <variable>customerCases</variable>
            </startingVariables>
        </task>
        <task name="UpdateAccountStateChangetoTerminal">
            <startingVariables>
                <variable>accountBOMUpdateToTerminal</variable>
                <variable>accountCaseUpdateToTerminal</variable>
            </startingVariables>
        </task>
        <task name="GetNonTerminalCasesSubsetofAccountsandCustomers">
            <startingVariables>
                <variable>customerCaseNonTerminal</variable>
                <variable>accountCasesTerminal</variable>
                <variable>customerCases</variable>
                <variable>accountCasesNonTerminal</variable>
                <variable>accountCases</variable>
            </startingVariables>
        </task>
        <task name="LinkCustomertoAccounts">
            <startingVariables>
                <variable>customerCaseNonTerminal</variable>
                <variable>accountCasesNonTerminal</variable>
            </startingVariables>
        </task>
        <task name="NavigationUnaffectedOperations">
            <startingVariables>
                <variable>accountCasesNavigateAll</variable>
                <variable>customerCaseNonTerminal</variable>
                <variable>accountCasesNavigateBySearch</variable>
                <variable>accountCasesNavigateByCriteria</variable>
            </startingVariables>
        </task>
        <task name="Unaffectedoperations">
            <startingVariables>
                <variable>accountCasesTerminal</variable>
                <variable>accountBOMsReadAll</variable>
                <variable>accountCaseFindByCID</variable>
                <variable>accountBOMsReadTerminal</variable>
                <variable>accountCases</variable>
            </startingVariables>
        </task>
    </tibex:VariableDescriptor>
    <bpws:documentation>*** Generated by TIBCO Business Studio.</bpws:documentation>
    <bpws:variables>
        <bpws:variable name="accountBOMs" tibex:array="yes"
            tibex:class="com.example.testcasedatascripting.Account" tibex:xpdlId="_VFCcINVbEemTTsOsy2W0nA"/>
        <bpws:variable name="accountCases" tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_a4Q_ANVbEemTTsOsy2W0nA"/>
        <bpws:variable name="accountCasesFindAll" tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_lr2dYNVbEemTTsOsy2W0nA"/>
        <bpws:variable name="accountCasesSimpleSearch" tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_fa2HcdVdEemTTsOsy2W0nA"/>
        <bpws:variable name="accountCasesFindByCriteria"
            tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_ZFXScNVlEemTTsOsy2W0nA"/>
        <bpws:variable name="customerCases" tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Customer" tibex:xpdlId="_0u_x0NVuEemTTsOsy2W0nA"/>
        <bpws:variable name="customerBOMs" tibex:array="yes"
            tibex:class="com.example.testcasedatascripting.Customer" tibex:xpdlId="_4qEgQNVuEemTTsOsy2W0nA"/>
        <bpws:variable name="customerCaseNonTerminal"
            tibex:classRef="com.example.testcasedatascripting.Customer" tibex:xpdlId="_M6JxcNVzEemTTsOsy2W0nA"/>
        <bpws:variable name="accountCasesNonTerminal" tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_P0Xf0NVzEemTTsOsy2W0nA"/>
        <bpws:variable name="accountCasesTerminal" tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_BPVRMNYEEem6Io9qtFiwPQ"/>
        <bpws:variable name="accountBOMsReadAll" tibex:array="yes"
            tibex:class="com.example.testcasedatascripting.Account" tibex:xpdlId="_CDwa8NYIEem6Io9qtFiwPQ"/>
        <bpws:variable name="accountBOMsReadTerminal" tibex:array="yes"
            tibex:class="com.example.testcasedatascripting.Account" tibex:xpdlId="_HXwEINYIEem6Io9qtFiwPQ"/>
        <bpws:variable name="accountCaseFindByCID"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_JEUeMNYJEem6Io9qtFiwPQ"/>
        <bpws:variable name="accountBOMUpdateToTerminal"
            tibex:class="com.example.testcasedatascripting.Account" tibex:xpdlId="_xRPhMNYhEemryZpHN5Dvcw"/>
        <bpws:variable name="accountCaseUpdateToTerminal"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_71-EMNYhEemryZpHN5Dvcw"/>
        <bpws:variable name="accountCasesNavigateAll" tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_ml1esNYyEemryZpHN5Dvcw"/>
        <bpws:variable name="accountCasesNavigateByCriteria"
            tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_rfbD0NYyEemryZpHN5Dvcw"/>
        <bpws:variable name="accountCasesNavigateBySearch"
            tibex:array="yes"
            tibex:classRef="com.example.testcasedatascripting.Account" tibex:xpdlId="_vCaCYNYyEemryZpHN5Dvcw"/>
    </bpws:variables>
    <bpws:extensions>
        <bpws:extension mustUnderstand="yes" namespace="http://www.tibco.com/bpel/2007/extensions"/>
    </bpws:extensions>
    <bpws:eventHandlers/>
    <bpws:flow name="_BX_flow_cLynENZFEemLg4LTGyRnrQ">
        <bpws:links>
            <bpws:link name="_2lZX4NYgEemryZpHN5Dvcw to EndEvent" tibex:xpdlId="_lglkINYBEem6Io9qtFiwPQ"/>
            <bpws:link name="StartEvent to CreateAccountsScript" tibex:xpdlId="_9t1FINVaEemTTsOsy2W0nA"/>
            <bpws:link name="CreateAccountsScript to CreateAccounts" tibex:xpdlId="_ZU688NVbEemTTsOsy2W0nA"/>
            <bpws:link
                name="_CNLd8NVeEemTTsOsy2W0nA to Unaffectedoperations" tibex:xpdlId="_7CuJxNVaEemTTsOsy2W0nA"/>
            <bpws:link
                name="_Gn8OgNVdEemTTsOsy2W0nA to _CNLd8NVeEemTTsOsy2W0nA" tibex:xpdlId="_CNLd8dVeEemTTsOsy2W0nA"/>
            <bpws:link
                name="_H2ecMNVzEemTTsOsy2W0nA to LinkCustomertoAccounts" tibex:xpdlId="_cDH7s9VzEemTTsOsy2W0nA"/>
            <bpws:link name="CreateCustomersScript to CreateCustomers" tibex:xpdlId="_VuqGQ9VuEemTTsOsy2W0nA"/>
            <bpws:link name="CreateCustomers to _H2ecMNVzEemTTsOsy2W0nA" tibex:xpdlId="_H2ecMdVzEemTTsOsy2W0nA"/>
            <bpws:link name="CreateAccounts to CreateCustomersScript" tibex:xpdlId="_TakjwdVuEemTTsOsy2W0nA"/>
            <bpws:link
                name="LinkCustomertoAccounts to _hVdr8NVbEemTTsOsy2W0nA" tibex:xpdlId="_hVdr8dVbEemTTsOsy2W0nA"/>
            <bpws:link
                name="_hVdr8NVbEemTTsOsy2W0nA to _Gn8OgNVdEemTTsOsy2W0nA" tibex:xpdlId="_Gn8OgdVdEemTTsOsy2W0nA"/>
            <bpws:link
                name="Unaffectedoperations to _vnkqINYgEemryZpHN5Dvcw" tibex:xpdlId="_vnlRMNYgEemryZpHN5Dvcw"/>
            <bpws:link
                name="_vnkqINYgEemryZpHN5Dvcw to _zaCPINYgEemryZpHN5Dvcw" tibex:xpdlId="_zaC2MNYgEemryZpHN5Dvcw"/>
            <bpws:link
                name="_zaCPINYgEemryZpHN5Dvcw to _2lZX4NYgEemryZpHN5Dvcw" tibex:xpdlId="_2lZ-8NYgEemryZpHN5Dvcw"/>
        </bpws:links>
        <bpws:extensionActivity>
            <tibex:receiveEvent createInstance="yes" eventTimeout="0"
                name="StartEvent" tibex:type="startEvent"
                tibex:xpdlId="_7CuJwtVaEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:sources>
                    <bpws:source linkName="StartEvent to CreateAccountsScript"/>
                </bpws:sources>
                <tibex:eventSource>
                    <tibex:startEvent eventType="Default"/>
                </tibex:eventSource>
            </tibex:receiveEvent>
        </bpws:extensionActivity>
        <bpws:empty name="EndEvent" tibex:migrationAllowed="yes"
            tibex:type="endEvent" tibex:xpdlId="_7CuJw9VaEemTTsOsy2W0nA">
            <bpws:targets>
                <bpws:target linkName="_2lZX4NYgEemryZpHN5Dvcw to EndEvent"/>
            </bpws:targets>
        </bpws:empty>
        <bpws:extensionActivity>
            <tibex:extActivity name="CreateAccountsScript"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_9t0eENVaEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="StartEvent to CreateAccountsScript"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="CreateAccountsScript to CreateAccounts"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[//0th case
var account0 = factory.com_example_testcasedatascripting.createAccount();
account0.accountBalance = 0.1234;
account0.accountInstitution = "Nationwide Building Society";
account0.accountOpened = new Date();
account0.accountOpened.setFullYear(1991);
account0.accountOpened.setMonth(1);
account0.accountOpened.setDate(1);
account0.accountOpened.setHours(1);
account0.accountOpened.setMinutes(1);
account0.accountOpened.setSeconds(1);
account0.accountOpened.setMilliseconds(101);
account0.accountLastAccessed = new Date();
account0.accountLastAccessed.setFullYear(2011);
account0.accountLastAccessed.setMonth(1);
account0.accountLastAccessed.setDate(1);
account0.accountLastAccessed.setHours(1);
account0.accountLastAccessed.setMinutes(1);
account0.accountLastAccessed.setSeconds(1);
account0.accountLastAccessed.setMilliseconds(101);
account0.accountStatus = pkg.com_example_testcasedatascripting.AccountStatus.ACTIVE;
account0.accountType = pkg.com_example_testdata_outside_global.AccountType.SAVINGS;
account0.institutionAddress = factory.com_example_testcasedatascripting.createAddress();
account0.institutionAddress.firstLine = "case 1 line 1";
account0.institutionAddress.secondLine = "case 1 line 2";
account0.institutionAddress.city = "case 1 city 1";
account0.institutionAddress.county = "case 1 county 1";
account0.institutionAddress.country = "case 1 country 1";
account0.institutionAddress.postcode = "SN1 1AP";
//1st case
var account1 = factory.com_example_testcasedatascripting.createAccount();
account1.accountBalance = 0.1234;
account1.accountInstitution = "Nationwide Building Society";
account1.accountOpened = new Date();
account1.accountOpened.setFullYear(1992);
account1.accountOpened.setMonth(2);
account1.accountOpened.setDate(2);
account1.accountOpened.setHours(2);
account1.accountOpened.setMinutes(2);
account1.accountOpened.setSeconds(2);
account1.accountOpened.setMilliseconds(202);
account1.accountLastAccessed = new Date();
account1.accountLastAccessed.setFullYear(2019);
account1.accountLastAccessed.setMonth(2);
account1.accountLastAccessed.setDate(2);
account1.accountLastAccessed.setHours(2);
account1.accountLastAccessed.setMinutes(2);
account1.accountLastAccessed.setSeconds(2);
account1.accountLastAccessed.setMilliseconds(202);
account1.accountStatus = pkg.com_example_testcasedatascripting.AccountStatus.DORMANT;
account1.accountType = pkg.com_example_testdata_outside_global.AccountType.CURRENT;
account1.institutionAddress = factory.com_example_testcasedatascripting.createAddress();
account1.institutionAddress.firstLine = "case 2 line 1";
account1.institutionAddress.secondLine = "case 2 line 2";
account1.institutionAddress.city = "case 2 city 1";
account1.institutionAddress.county = "case 2 county 1";
account1.institutionAddress.country = "case 2 country 1";
account1.institutionAddress.postcode = "SN2 2AP";
//2nd case
var account2 = factory.com_example_testcasedatascripting.createAccount();
account2.accountBalance = 0.1234;
account2.accountInstitution = "Nationwide Building Society";
account2.accountOpened = new Date();
account2.accountOpened.setFullYear(1993);
account2.accountOpened.setMonth(3);
account2.accountOpened.setDate(3);
account2.accountOpened.setHours(3);
account2.accountOpened.setMinutes(3);
account2.accountOpened.setSeconds(3);
account2.accountOpened.setMilliseconds(303);
account2.accountLastAccessed = new Date();
account2.accountLastAccessed.setFullYear(2013);
account2.accountLastAccessed.setMonth(3);
account2.accountLastAccessed.setDate(3);
account2.accountLastAccessed.setHours(3);
account2.accountLastAccessed.setMinutes(3);
account2.accountLastAccessed.setSeconds(3);
account2.accountLastAccessed.setMilliseconds(303);
account2.accountStatus = pkg.com_example_testcasedatascripting.AccountStatus.TOBETERMINATED;
account2.accountType = pkg.com_example_testdata_outside_global.AccountType.FIXEDDEPOSIT;
account2.institutionAddress = factory.com_example_testcasedatascripting.createAddress();
account2.institutionAddress.firstLine = "case 3 line 1";
account2.institutionAddress.secondLine = "case 3 line 2";
account2.institutionAddress.city = "case 3 city 1";
account2.institutionAddress.county = "case 3 county 1";
account2.institutionAddress.country = "case 3 country 1";
account2.institutionAddress.postcode = "SN3 3AP";
//3rd case
var account3 = factory.com_example_testcasedatascripting.createAccount();
account3.accountBalance = 0.1234;
account3.accountInstitution = "Nationwide Building Society";
account3.accountOpened = new Date();
account3.accountOpened.setFullYear(1994);
account3.accountOpened.setMonth(4);
account3.accountOpened.setDate(4);
account3.accountOpened.setHours(4);
account3.accountOpened.setMinutes(4);
account3.accountOpened.setSeconds(4);
account3.accountOpened.setMilliseconds(404);
account3.accountLastAccessed = new Date();
account3.accountLastAccessed.setFullYear(2014);
account3.accountLastAccessed.setMonth(4);
account3.accountLastAccessed.setDate(4);
account3.accountLastAccessed.setHours(4);
account3.accountLastAccessed.setMinutes(4);
account3.accountLastAccessed.setSeconds(4);
account3.accountLastAccessed.setMilliseconds(404);
account3.accountStatus = pkg.com_example_testcasedatascripting.AccountStatus.BARRED;
account3.accountType = pkg.com_example_testdata_outside_global.AccountType.INVESTMENT;
account3.institutionAddress = factory.com_example_testcasedatascripting.createAddress();
account3.institutionAddress.firstLine = "case 4 line 1";
account3.institutionAddress.secondLine = "case 4 line 2";
account3.institutionAddress.city = "case 4 city 1";
account3.institutionAddress.county = "case 4 county 1";
account3.institutionAddress.country = "case 4 country 1";
account3.institutionAddress.postcode = "SN4 4AP";
//push all cases into the array
data.accountBOMs.push(account0);
data.accountBOMs.push(account1);
data.accountBOMs.push(account2);
data.accountBOMs.push(account3);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="CreateAccounts"
                tibex:migrationAllowed="yes" tibex:type="serviceTask"
                tibex:xpdlId="_ZU6V4NVbEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="CreateAccountsScript to CreateAccounts"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="CreateAccounts to CreateCustomersScript"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.accountCases.length=0;data.accountCases.pushAll(bpm.caseData.createAll(data.accountBOMs,'com.example.testcasedatascripting.Account'));]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="FindAllWillfindnonterminalcases"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_hVdr8NVbEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="LinkCustomertoAccounts to _hVdr8NVbEemTTsOsy2W0nA"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_hVdr8NVbEemTTsOsy2W0nA to _Gn8OgNVdEemTTsOsy2W0nA"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.accountCasesFindAll.length = 0;
data.accountCasesFindAll.pushAll(bpm.caseData.findAll('com.example.testcasedatascripting.Account',0,10));
var lengthAccountCasesFindAll = data.accountCasesFindAll.length; //2
var accountBOMFindAll0 = factory.com_example_testcasedatascripting.createAccount();
var accountBOMFindAll1 = factory.com_example_testcasedatascripting.createAccount();
accountBOMFindAll0 = bpm.caseData.read(data.accountCasesFindAll[0]);
accountBOMFindAll1 = bpm.caseData.read(data.accountCasesFindAll[1]);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="SearchWillsearchnonterminalcases"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_Gn8OgNVdEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_hVdr8NVbEemTTsOsy2W0nA to _Gn8OgNVdEemTTsOsy2W0nA"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_Gn8OgNVdEemTTsOsy2W0nA to _CNLd8NVeEemTTsOsy2W0nA"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.accountCasesSimpleSearch.length = 0;
data.accountCasesSimpleSearch.pushAll(bpm.caseData.findBySimpleSearch('0.1234','com.example.testcasedatascripting.Account',0,10));
var lengthAccountCasesSimpleSearch = data.accountCasesSimpleSearch.length; //2
var accountBOMSimpleSearch0 = factory.com_example_testcasedatascripting.createAccount();
var accountBOMSimpleSearch1 = factory.com_example_testcasedatascripting.createAccount();
accountBOMSimpleSearch0 = bpm.caseData.read(data.accountCasesSimpleSearch[0]);
accountBOMSimpleSearch1 = bpm.caseData.read(data.accountCasesSimpleSearch[1]);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity
                name="FindBycriteriaWillfindnonterminalcases"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_CNLd8NVeEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_Gn8OgNVdEemTTsOsy2W0nA to _CNLd8NVeEemTTsOsy2W0nA"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_CNLd8NVeEemTTsOsy2W0nA to Unaffectedoperations"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.accountCasesFindByCriteria.length = 0;
data.accountCasesFindByCriteria.pushAll(bpm.caseData.findByCriteria("accountBalance = 0.1234 and accountInstitution = 'Nationwide Building Society'",'com.example.testcasedatascripting.Account',0,10));
var lengthAccountCasesFindByCriteria = data.accountCasesFindByCriteria.length; //2
var accountBOMFindByCriteria0 = factory.com_example_testcasedatascripting.createAccount();
var accountBOMFindByCriteria1 = factory.com_example_testcasedatascripting.createAccount();
accountBOMFindByCriteria0 = bpm.caseData.read(data.accountCasesFindByCriteria[0]);
accountBOMFindByCriteria1 = bpm.caseData.read(data.accountCasesFindByCriteria[1]);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="CreateCustomersScript"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_TakjwNVuEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="CreateAccounts to CreateCustomersScript"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="CreateCustomersScript to CreateCustomers"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[//0th customer
var customerBOM0 = factory.com_example_testcasedatascripting.createCustomer();
customerBOM0.customerID = 'ID0001';
customerBOM0.age = 0.01;
customerBOM0.dateofBirth = new Date('1911-01-01');
customerBOM0.customerCategory = pkg.com_example_testcasedatascripting.CustomerCategory.MEDIUMACTIVITY;
customerBOM0.residentialAddress = factory.com_example_testcasedatascripting.createAddress();
customerBOM0.residentialAddress.firstLine = 'customer 1 line 1';
customerBOM0.residentialAddress.secondLine = 'customer 1 line 2';
customerBOM0.residentialAddress.city = 'customer 1 city 1';
customerBOM0.residentialAddress.county = 'customer 1 county 1';
customerBOM0.residentialAddress.country = 'customer 1 country 1';
customerBOM0.residentialAddress.postcode = 'SN1 1AP';
var employmentDetails1 = factory.com_example_testdata_outside_global.createEmploymentDetails();
var employmentDetails2 = factory.com_example_testdata_outside_global.createEmploymentDetails();
employmentDetails1.employeeID = '1001';
employmentDetails1.employmentStatus= pkg.com_example_testdata_outside_global.EmploymentStatus.FULLTIMESALARIED;
employmentDetails1.numberofyears = 1;
employmentDetails1.yearlyRenumeration = 1111.11;
employmentDetails2.employeeID = '1002';
employmentDetails2.employmentStatus= pkg.com_example_testdata_outside_global.EmploymentStatus.PARTTIMESALARIED;
employmentDetails2.numberofyears = 1;
employmentDetails2.yearlyRenumeration = 1111.11;
customerBOM0.employmentDetails.push(employmentDetails1, employmentDetails2);
//1st customer
var customerBOM1 = factory.com_example_testcasedatascripting.createCustomer();
customerBOM1.customerID = 'ID0002';
customerBOM1.age = 0.02;
customerBOM1.dateofBirth = new Date('1921-02-02');
customerBOM1.customerCategory = pkg.com_example_testcasedatascripting.CustomerCategory.TERMINATED;
customerBOM1.residentialAddress = factory.com_example_testcasedatascripting.createAddress();
customerBOM1.residentialAddress.firstLine = 'customer 2 line 1';
customerBOM1.residentialAddress.secondLine = 'customer 2 line 2';
customerBOM1.residentialAddress.city = 'customer 2 city 1';
customerBOM1.residentialAddress.county = 'customer 2 county 1';
customerBOM1.residentialAddress.country = 'customer 2 country 1';
customerBOM1.residentialAddress.postcode = 'SN2 2AP';
var employmentDetails3 = factory.com_example_testdata_outside_global.createEmploymentDetails();
var employmentDetails4 = factory.com_example_testdata_outside_global.createEmploymentDetails();
employmentDetails3.employeeID = '2001';
employmentDetails3.employmentStatus= pkg.com_example_testdata_outside_global.EmploymentStatus.RETIRED;
employmentDetails3.numberofyears = 25;
employmentDetails3.yearlyRenumeration = 0.01;
employmentDetails4.employeeID = '2002';
employmentDetails4.employmentStatus= pkg.com_example_testdata_outside_global.EmploymentStatus.RESIGNED;
employmentDetails4.numberofyears = 20;
employmentDetails4.yearlyRenumeration = 0.02;
customerBOM1.employmentDetails.push(employmentDetails3, employmentDetails4);
//add the objects into the array
data.customerBOMs.push(customerBOM0, customerBOM1);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="CreateCustomers"
                tibex:migrationAllowed="yes" tibex:type="serviceTask"
                tibex:xpdlId="_VuqGQNVuEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="CreateCustomersScript to CreateCustomers"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="CreateCustomers to _H2ecMNVzEemTTsOsy2W0nA"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.customerCases.length=0;data.customerCases.pushAll(bpm.caseData.createAll(data.customerBOMs,'com.example.testcasedatascripting.Customer'));]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity
                name="GetNonTerminalCasesSubsetofAccountsandCustomers"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_H2ecMNVzEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="CreateCustomers to _H2ecMNVzEemTTsOsy2W0nA"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_H2ecMNVzEemTTsOsy2W0nA to LinkCustomertoAccounts"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.customerCaseNonTerminal = data.customerCases[0];
data.accountCasesNonTerminal.push(data.accountCases[0]);
data.accountCasesNonTerminal.push(data.accountCases[1]);
data.accountCasesTerminal.push(data.accountCases[2]);
data.accountCasesTerminal.push(data.accountCases[3]);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="LinkCustomertoAccounts"
                tibex:migrationAllowed="yes" tibex:type="serviceTask"
                tibex:xpdlId="_cDH7sNVzEemTTsOsy2W0nA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_H2ecMNVzEemTTsOsy2W0nA to LinkCustomertoAccounts"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="LinkCustomertoAccounts to _hVdr8NVbEemTTsOsy2W0nA"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[bpm.caseData.linkAll(data.customerCaseNonTerminal,data.accountCasesNonTerminal,'accounts');]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="Unaffectedoperations"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_jIqDcNYBEem6Io9qtFiwPQ" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_CNLd8NVeEemTTsOsy2W0nA to Unaffectedoperations"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="Unaffectedoperations to _vnkqINYgEemryZpHN5Dvcw"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[//read a case in terminal state
var accountBOMReadTerminal = factory.com_example_testcasedatascripting.createAccount();
accountBOMReadTerminal = bpm.caseData.read(data.accountCases[2]);
//read All mix of terminal and non-terminal
data.accountBOMsReadAll.length = 0;
data.accountBOMsReadAll.pushAll(bpm.caseData.readAll(data.accountCases));
var lengthAccountBOMsReadAll = data.accountBOMsReadAll.length;
//read All non-terminal
data.accountBOMsReadTerminal.length = 0;
data.accountBOMsReadTerminal.pushAll(bpm.caseData.readAll(data.accountCasesTerminal));
var lengthAccountBOMsReadTerminal = data.accountBOMsReadTerminal.length;
//find by cid
var accountBOMReadFindCIDTerminal = factory.com_example_testcasedatascripting.createAccount();
data.accountCaseFindByCID = bpm.caseData.findByCaseIdentifier('Account00004','com.example.testcasedatascripting.Account');
//assert account cid not null
accountBOMReadFindCIDTerminal = bpm.caseData.read(data.accountCaseFindByCID);
]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity
                name="UpdateNonTerminalAccounttoTerminalScript"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_vnkqINYgEemryZpHN5Dvcw" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="Unaffectedoperations to _vnkqINYgEemryZpHN5Dvcw"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_vnkqINYgEemryZpHN5Dvcw to _zaCPINYgEemryZpHN5Dvcw"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.accountCaseUpdateToTerminal = data.accountCases[1];
data.accountBOMUpdateToTerminal = bpm.caseData.read(data.accountCases[1]);
data.accountBOMUpdateToTerminal.accountStatus = pkg.com_example_testcasedatascripting.AccountStatus.BARRED;
]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="UpdateAccountStateChangetoTerminal"
                tibex:migrationAllowed="yes" tibex:type="serviceTask"
                tibex:xpdlId="_zaCPINYgEemryZpHN5Dvcw" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_vnkqINYgEemryZpHN5Dvcw to _zaCPINYgEemryZpHN5Dvcw"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_zaCPINYgEemryZpHN5Dvcw to _2lZX4NYgEemryZpHN5Dvcw"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[data.accountCaseUpdateToTerminal = bpm.caseData.updateByRef(data.accountCaseUpdateToTerminal,data.accountBOMUpdateToTerminal);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="NavigationUnaffectedOperations"
                tibex:migrationAllowed="yes" tibex:type="scriptTask"
                tibex:xpdlId="_2lZX4NYgEemryZpHN5Dvcw" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_zaCPINYgEemryZpHN5Dvcw to _2lZX4NYgEemryZpHN5Dvcw"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="_2lZX4NYgEemryZpHN5Dvcw to EndEvent"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[//navigate by criteria
data.accountCasesNavigateByCriteria.pushAll(bpm.caseData.navigateByCriteria(data.customerCaseNonTerminal, 'accounts', "accountStatus = 'BARRED'", 0, 10));
var lengthAccountCasesNavigateByCriteria = data.accountCasesNavigateByCriteria.length; //1
var accountBOMNavigatedByCriteria = factory.com_example_testcasedatascripting.createAccount();
accountBOMNavigatedByCriteria = bpm.caseData.read(data.accountCasesNavigateByCriteria[0]);
//navigate by search
data.accountCasesNavigateBySearch.pushAll(bpm.caseData.navigateBySimpleSearch(data.customerCaseNonTerminal, 'accounts', "Account00002", 0, 10));
var lengthAccountCasesNavigateBySearch = data.accountCasesNavigateBySearch.length; //1
var accountBOMNavigatedBySearch = factory.com_example_testcasedatascripting.createAccount();
accountBOMNavigatedBySearch = bpm.caseData.read(data.accountCasesNavigateBySearch[0]);
//navigate All
data.accountCasesNavigateAll.pushAll(bpm.caseData.navigateAll(data.customerCaseNonTerminal, 'accounts', 0, 10));
var lengthAccountCasesNavigateAll = data.accountCasesNavigateAll.length; //2
var accountBOMNavigateAll0 = factory.com_example_testcasedatascripting.createAccount();
var accountBOMNavigateAll1 = factory.com_example_testcasedatascripting.createAccount();
accountBOMNavigateAll0 = bpm.caseData.read(data.accountCasesNavigateAll[0]);
accountBOMNavigateAll1 = bpm.caseData.read(data.accountCasesNavigateAll[1]);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
    </bpws:flow>
</bpws:process>
